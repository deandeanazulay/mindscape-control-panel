@import "./styles/vars.css";
@import "./styles/path.css";
@tailwind base;
@tailwind components;
@tailwind utilities;

/* Definition of the design system. All colors, gradients, fonts, etc should be defined here. 
All colors MUST be HSL.
*/

@layer base {
  :root {
    /* Core surfaces - Neutral dark gray */
    --background: 220 8% 8%; /* #121315 */
    --foreground: 220 6% 93%; /* #ECEDEE */

    --card: 215 10% 10%; /* #16181B */
    --card-foreground: 220 6% 93%;

    --popover: 215 10% 10%;
    --popover-foreground: 220 6% 93%;

    /* Accent (Twitter Blue) applied to primary + accent */
    --primary: 203 89% 53%; /* #1DA1F2 */
    --primary-foreground: 0 0% 100%;

    --secondary: 215 10% 12%;
    --secondary-foreground: 220 6% 93%;

    --muted: 215 9% 14%;
    --muted-foreground: 220 6% 66%; /* #A1A1AA */

    --accent: 203 89% 53%; /* #1DA1F2 */
    --accent-foreground: 220 6% 93%;
    /* Interaction shades for accent */
    --accent-hover: 203 89% 48%;
    --accent-press: 203 89% 43%;

    --destructive: 0 84% 60%;
    --destructive-foreground: 210 40% 98%;

    --border: 215 12% 19%; /* #2A2E34 */
    --input: 215 12% 19%;
    --ring: 203 89% 53%; /* focus ring = accent */

    --radius: 1.25rem;

    /* Sidebar tokens */
    --sidebar-background: 220 8% 9%;
    --sidebar-foreground: 220 6% 93%;
    --sidebar-primary: 215 7% 45%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 215 10% 12%;
    --sidebar-accent-foreground: 220 6% 93%;
    --sidebar-border: 215 12% 19%;
    --sidebar-ring: 214 20% 57%;

    /* Premium additions */
    --glass-bg: 215 12% 13% / 0.60; /* hsla of #1D2024 */
    --glass-border: 215 12% 28% / 0.35;
    --shadow-elev: 0 16px 50px -16px hsl(var(--primary) / 0.35);
    --shadow-soft: 0 8px 30px -12px hsl(var(--foreground) / 0.08);
    --gradient-primary: linear-gradient(140deg, hsl(var(--primary) / 0.90), hsl(var(--primary) / 0.70));
    --gradient-surface: linear-gradient(180deg, hsl(215 12% 13% / 0.70), hsl(220 8% 8% / 0.50));

    /* Motion */
    --transition-smooth: all 300ms cubic-bezier(0.22, 1, 0.36, 1);
  }

  .light {
    --background: 0 0% 99%;
    --foreground: 222.2 84% 4.9%;
    --card: 0 0% 100%;
    --card-foreground: 222.2 84% 4.9%;
    --popover: 0 0% 100%;
    --popover-foreground: 222.2 84% 4.9%;
    --primary: 203 89% 53%;
    --primary-foreground: 0 0% 100%;
    --secondary: 210 40% 96%;
    --secondary-foreground: 222.2 47.4% 11.2%;
    --muted: 210 40% 96.1%;
    --muted-foreground: 215.4 16.3% 46.9%;
    --accent: 203 89% 53%;
    --accent-foreground: 222.2 47.4% 11.2%;
    /* Interaction shades for accent (light) */
    --accent-hover: 203 89% 47%;
    --accent-press: 203 89% 43%;
    --destructive: 0 84% 60%;
    --destructive-foreground: 210 40% 98%;
    --border: 214.3 31.8% 91.4%;
    --input: 214.3 31.8% 91.4%;
    --ring: 203 89% 53%;
    --glass-bg: 0 0% 100% / 0.55;
    --glass-border: 220 14% 60% / 0.35;
    --gradient-surface: linear-gradient(180deg, hsl(0 0% 100% / 0.70), hsl(0 0% 100% / 0.60));
  }
}

@layer base {
  * {
    @apply border-border;
  }

  html, body, #root {
    height: 100%;
  }

  body {
    @apply bg-background text-foreground antialiased;
    font-family: "Nunito", ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    background-image: radial-gradient(1200px 600px at 10% 10%, hsl(var(--primary) / 0.12), transparent 40%),
      radial-gradient(1000px 500px at 90% 30%, hsl(var(--accent) / 0.10), transparent 40%),
      linear-gradient(180deg, hsl(220 8% 9%), hsl(220 8% 7%));
    background-attachment: fixed;
  }

  /* Utilities for glass panels */
  .glass-panel {
    background: var(--gradient-surface);
    backdrop-filter: blur(16px) saturate(120%);
    -webkit-backdrop-filter: blur(16px) saturate(120%);
    box-shadow: var(--shadow-soft);
    border: 1px solid hsl(var(--glass-border));
  }

  .elev {
    box-shadow: var(--shadow-elev);
  }

  .smooth {
    transition: var(--transition-smooth);
  }
}

@layer base {
  .light body {
    background-image: radial-gradient(1200px 600px at 10% 10%, hsl(var(--primary) / 0.10), transparent 45%),
      radial-gradient(1000px 500px at 90% 30%, hsl(var(--accent) / 0.08), transparent 45%),
      linear-gradient(180deg, hsl(0 0% 100%), hsl(0 0% 98%));
  }
}

@layer utilities {
  .hover-scale {
    @apply transition-transform duration-200 hover:scale-105;
  }

  .story-link {
    position: relative;
    display: inline-block;
  }
  .story-link::after {
    content: "";
    position: absolute;
    left: 0;
    bottom: 0;
    width: 100%;
    height: 2px;
    background: hsl(var(--primary));
    transform: scaleX(0);
    transform-origin: bottom right;
    transition: transform 300ms ease;
  }
  .story-link:hover::after {
    transform: scaleX(1);
    transform-origin: bottom left;
  }
}

/* Subtle animated glow for active focus card */
.focus-glow { position: relative; }
.focus-glow::after {
  content: "";
  position: absolute;
  inset: -6px;
  border-radius: 1rem;
  pointer-events: none;
  box-shadow: 0 0 0 0 hsl(var(--accent) / 0.0), 0 0 40px 0 hsl(var(--accent) / 0.35);
  animation: focus-glow-pulse 2.4s ease-in-out infinite;
}
@keyframes focus-glow-pulse {
  0%, 100% { box-shadow: 0 0 0 0 hsl(var(--accent) / 0.0), 0 0 30px 0 hsl(var(--accent) / 0.28); }
  50% { box-shadow: 0 0 0 0 hsl(var(--accent) / 0.0), 0 0 46px 0 hsl(var(--accent) / 0.40); }
}
@media (prefers-reduced-motion: reduce) {
  .focus-glow::after { animation: none; }
}

/* Sparkle effect for streak increases */
.sparkle { position: relative; }
.sparkle::after {
  content: "";
  position: absolute;
  top: -6px; right: -6px;
  width: 12px; height: 12px;
  background: radial-gradient(circle at 50% 50%, hsl(var(--accent)) 0, transparent 60%);
  filter: blur(0.3px);
  animation: sparkle-pop 900ms ease-out forwards;
}
@keyframes sparkle-pop {
  0% { transform: scale(0.2); opacity: 0; }
  40% { transform: scale(1.3); opacity: 1; }
  100% { transform: scale(1); opacity: 0; }
}

/* Ambient animated gradient for hero */
.hero-ambient {
  background-image:
    radial-gradient(1200px 600px at 20% 0%, hsl(var(--primary) / 0.25), transparent 50%),
    radial-gradient(1000px 500px at 80% 20%, hsl(var(--accent) / 0.20), transparent 50%),
    var(--gradient-surface);
  animation: ambient-shift 12s ease-in-out infinite alternate;
}
@keyframes ambient-shift {
  0% { background-position: 0% 0%, 100% 0%, 0 0; }
  100% { background-position: 20% 10%, 80% 30%, 0 0; }
}
/* Mood modifiers */
.hero-ambient.calm { --primary: 210 90% 60%; --accent: 210 90% 60%; }
.hero-ambient.confident { --primary: 45 95% 55%; --accent: 35 95% 55%; }
.hero-ambient.focused { --primary: 203 89% 53%; --accent: 203 89% 53%; }

/* Flame flicker */
.flame-flicker { animation: flame-flicker 1.2s ease-in-out infinite; transform-origin: center; }
@keyframes flame-flicker {
  0%, 100% { transform: scale(1); filter: drop-shadow(0 0 6px hsl(var(--destructive) / 0.6)); }
  50% { transform: scale(1.05); filter: drop-shadow(0 0 10px hsl(var(--destructive) / 0.8)); }
}
@media (prefers-reduced-motion: reduce) { .flame-flicker { animation: none; } }

/* Liquid text shimmer */
.liquid-text {
  background: linear-gradient(90deg, hsl(var(--accent)), hsl(var(--accent) / 0.6), hsl(var(--accent)));
  -webkit-background-clip: text; background-clip: text; color: transparent;
  background-size: 200% 100%;
  animation: liquid-move 2.5s linear infinite;
}
@keyframes liquid-move { 0% { background-position: 0% 50% } 100% { background-position: 200% 50% } }

/* Safe area helper */
.dock-safe { padding-bottom: calc(env(safe-area-inset-bottom) + 12px); }
.pb-safe { padding-bottom: calc(env(safe-area-inset-bottom) + 12px); }
.pt-safe { padding-top: calc(env(safe-area-inset-top) + 12px); }

/* Idle float for avatar */
.idle-float { animation: idle-float 4s ease-in-out infinite; }
@keyframes idle-float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-6px); }
}
@media (prefers-reduced-motion: reduce) { .idle-float { animation: none; } }

/* Hub scene backgrounds */
.hub-scene { position: relative; overflow: hidden; background: var(--gradient-surface); transition: var(--transition-smooth); }
.hub-scene .world-sky {
  background-image:
    radial-gradient(1400px 700px at 20% -10%, hsl(var(--primary) / 0.25), transparent 55%),
    radial-gradient(1200px 600px at 80% 0%, hsl(var(--accent) / 0.20), transparent 50%),
    linear-gradient(180deg, hsl(220 8% 10%), hsl(220 8% 7%));
}
.hub-scene .world-hills {
  background:
    radial-gradient(80% 100% at 50% 120%, hsl(var(--muted)) 0%, transparent 60%),
    radial-gradient(60% 100% at 20% 110%, hsl(var(--secondary)) 0%, transparent 60%),
    radial-gradient(60% 100% at 80% 110%, hsl(var(--secondary)) 0%, transparent 60%);
  filter: blur(1px);
}
.hub-scene .world-particles { background-image: radial-gradient(circle at 50% 20%, hsl(var(--accent) / 0.08) 0.5px, transparent 0.5px); background-size: 120px 120px; opacity: 0.35; }

/* Mood tints for hub scene */
.hub-scene.calm { --primary: 210 90% 60%; --accent: 210 90% 60%; }
.hub-scene.confident { --primary: 45 95% 55%; --accent: 35 95% 55%; }
.hub-scene.focused { --primary: 203 89% 53%; --accent: 203 89% 53%; }
.hub-scene.tired { --primary: 260 14% 46%; --accent: 260 14% 46%; }
.hub-scene.stressed { --primary: 0 74% 60%; --accent: 0 74% 60%; }

/* Side-scroll world */
.world-viewport { position: relative; width: 100%; height: 100%; overflow: hidden; }
.world-canvas { position: absolute; inset: 0; }
.world-track { position: absolute; left:0; top:0; height:100%; will-change: transform; }
.world-ground { position: absolute; left:0; right:0; bottom:12%; height: 4px; background: hsl(var(--border)); box-shadow: 0 2px 0 hsl(var(--muted)); }
.building { position: absolute; bottom: 12%; width: 220px; height: 140px; border: 1px solid hsl(var(--border)); background: linear-gradient(180deg, hsl(var(--secondary) / 0.8), hsl(var(--secondary))); border-radius: 14px; box-shadow: var(--shadow-soft); }
.building .label { position:absolute; top:-28px; left:50%; transform: translateX(-50%); font-size: 12px; color: hsl(var(--muted-foreground)); background: hsl(var(--background) / 0.6); padding: 2px 8px; border-radius: 999px; border: 1px solid hsl(var(--border)); backdrop-filter: blur(6px); }
.door { position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 48px; height: 70px; border-radius: 8px 8px 0 0; background: hsl(var(--background)); border: 2px solid hsl(var(--border)); box-shadow: inset 0 0 10px hsl(var(--accent) / 0.1); }
.door.glow { box-shadow: 0 0 0 0 hsl(var(--accent) / 0.0), 0 0 24px 6px hsl(var(--accent) / 0.45); border-color: hsl(var(--accent)); }
.npc { position: absolute; bottom: 12%; width: 40px; height: 40px; border-radius: 12px; background: linear-gradient(180deg, hsl(var(--primary) / 0.4), hsl(var(--primary) / 0.2)); border: 1px solid hsl(var(--border)); display: grid; place-items: center; }
.hint { position: absolute; bottom: calc(12% + 150px); left:50%; transform: translateX(-50%); font-size: 12px; color: hsl(var(--foreground)); background: hsl(var(--background) / 0.7); padding: 6px 10px; border-radius: 10px; border: 1px solid hsl(var(--border)); white-space: nowrap; }
.player { position: absolute; bottom: calc(12% + 70px); width: 80px; height: 80px; }
.parallax-foreground { position:absolute; inset:0; pointer-events:none; background-image: radial-gradient(6px 6px at 10% 90%, hsl(var(--accent) / 0.15), transparent 60%), radial-gradient(6px 6px at 90% 88%, hsl(var(--primary) / 0.15), transparent 60%); background-size: 200px 200px; opacity: 0.4; }
.controls-safe { padding-bottom: calc(env(safe-area-inset-bottom) + 16px); }

